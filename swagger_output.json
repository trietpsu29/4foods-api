{
  "swagger": "2.0",
  "info": {
    "title": "4Foods API",
    "description": "API documentation for 4Foods Android app",
    "version": "1.0.0"
  },
  "host": "api.4foods.app",
  "basePath": "/",
  "schemes": ["https"],
  "consumes": ["application/json"],
  "produces": ["application/json"],
  "securityDefinitions": {
    "Bearer": {
      "type": "apiKey",
      "name": "Authorization",
      "in": "header",
      "description": "Enter your bearer token in the format **Bearer <token>**"
    }
  },
  "paths": {
    "/auth/check-email": {
      "get": {
        "tags": ["Auth"],
        "summary": "Check if email already exists",
        "parameters": [
          {
            "name": "email",
            "in": "query",
            "required": true,
            "type": "string",
            "example": "user@example.com"
          }
        ],
        "responses": {
          "200": {
            "description": "Email check result",
            "examples": {
              "application/json": {
                "exists": false
              }
            }
          },
          "400": {
            "description": "Missing email",
            "examples": {
              "application/json": {
                "error": "Missing email"
              }
            }
          }
        }
      }
    },

    "/auth/register": {
      "post": {
        "tags": ["Auth"],
        "summary": "Register new user",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "properties": {
                "name": { "type": "string", "example": "Posu" },
                "email": { "type": "string", "example": "posu@example.com" },
                "password": { "type": "string", "example": "mypassword123" },
                "role": { "type": "string", "example": "user" }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User registered successfully",
            "examples": {
              "application/json": {
                "message": "Account created successfully",
                "user": {
                  "id": "672f8d42b9a12345c1234567",
                  "email": "posu@example.com"
                }
              }
            }
          },
          "400": {
            "description": "Validation error"
          }
        }
      }
    },

    "/auth/login": {
      "post": {
        "tags": ["Auth"],
        "summary": "Login user",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "properties": {
                "email": { "type": "string", "example": "posu@example.com" },
                "password": { "type": "string", "example": "mypassword123" }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Login success",
            "examples": {
              "application/json": {
                "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                "user": {
                  "id": "672f8d42b9a12345c1234567",
                  "name": "Posu",
                  "email": "posu@example.com",
                  "role": "user",
                  "isSeller": false
                }
              }
            }
          },
          "401": {
            "description": "Invalid credentials"
          }
        }
      }
    },

    "/auth/google": {
      "post": {
        "tags": ["Auth"],
        "summary": "Login or register via Google OAuth",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "properties": {
                "credential": {
                  "type": "string",
                  "example": "ya29.a0AfH6SM..."
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Google login success",
            "examples": {
              "application/json": {
                "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                "user": {
                  "id": "672f8d42b9a12345c1234567",
                  "name": "Posu",
                  "email": "posu@example.com",
                  "isSeller": false
                }
              }
            }
          }
        }
      }
    },

    "/auth/facebook": {
      "post": {
        "tags": ["Auth"],
        "summary": "Login or register via Facebook OAuth",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "properties": {
                "accessToken": {
                  "type": "string",
                  "example": "EAAGm0PX4ZCpsBAKZCZ..."
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Facebook login success",
            "examples": {
              "application/json": {
                "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                "user": {
                  "id": "672f8d42b9a12345c1234567",
                  "name": "Posu",
                  "email": "posu@example.com",
                  "isSeller": false
                }
              }
            }
          },
          "400": {
            "description": "Missing access token or invalid Facebook response"
          }
        }
      }
    },

    "/auth/forgot-password": {
      "post": {
        "tags": ["Auth"],
        "summary": "Request OTP to reset password",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "properties": {
                "email": {
                  "type": "string",
                  "example": "posu@example.com"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OTP sent successfully",
            "examples": {
              "application/json": {
                "message": "OTP sent to email"
              }
            }
          },
          "404": {
            "description": "User not found"
          }
        }
      }
    },

    "/auth/verify-otp": {
      "post": {
        "tags": ["Auth"],
        "summary": "Verify OTP code from email",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "properties": {
                "email": { "type": "string", "example": "posu@example.com" },
                "code": { "type": "string", "example": "54321" }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OTP verified successfully",
            "examples": {
              "application/json": {
                "message": "OTP verified successfully"
              }
            }
          },
          "400": {
            "description": "Invalid or expired OTP"
          }
        }
      }
    },

    "/auth/reset-password": {
      "post": {
        "tags": ["Auth"],
        "summary": "Reset password using verified OTP",
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "properties": {
                "email": { "type": "string", "example": "posu@example.com" },
                "newPassword": { "type": "string", "example": "newpassword123" }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Password updated successfully",
            "examples": {
              "application/json": {
                "message": "Password updated successfully"
              }
            }
          },
          "400": {
            "description": "OTP expired or invalid"
          }
        }
      }
    },
    "/user/me": {
      "get": {
        "tags": ["User"],
        "summary": "Lấy thông tin tài khoản của người dùng hiện tại",
        "security": [{ "Bearer": [] }],
        "responses": {
          "200": {
            "description": "Thông tin người dùng hiện tại",
            "examples": {
              "application/json": {
                "id": "6754b6f82e9c2a4f77f1b5d1",
                "name": "Nguyễn Văn A",
                "email": "a@example.com",
                "phone": "0912345678",
                "isSeller": false,
                "role": "user",
                "addresses": [],
                "createdAt": "2025-10-30T12:00:00.000Z"
              }
            }
          }
        }
      },
      "put": {
        "tags": ["User"],
        "summary": "Cập nhật thông tin cá nhân",
        "security": [{ "Bearer": [] }],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "schema": {
              "type": "object",
              "properties": {
                "name": { "type": "string" },
                "email": { "type": "string" },
                "phone": { "type": "string" },
                "idCardNumber": { "type": "string" },
                "permanentAddress": { "type": "string" },
                "dob": { "type": "string", "format": "date" },
                "avatar": { "type": "string" }
              }
            },
            "example": {
              "name": "Nguyễn Văn A",
              "phone": "0987654321",
              "dob": "2001-03-15",
              "permanentAddress": "Hà Nội, Việt Nam"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cập nhật thành công",
            "examples": {
              "application/json": {
                "id": "6754b6f82e9c2a4f77f1b5d1",
                "name": "Nguyễn Văn A",
                "phone": "0987654321",
                "dob": "2001-03-15T00:00:00.000Z"
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["User"],
        "summary": "Xóa tài khoản người dùng hiện tại",
        "security": [{ "Bearer": [] }],
        "responses": {
          "200": {
            "description": "Xóa thành công",
            "examples": {
              "application/json": {
                "message": "Your account has been deleted successfully"
              }
            }
          }
        }
      }
    },

    "/user/me/change-password": {
      "put": {
        "tags": ["User"],
        "summary": "Đổi mật khẩu cá nhân",
        "security": [{ "Bearer": [] }],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "schema": {
              "type": "object",
              "required": ["oldPassword", "newPassword"],
              "properties": {
                "oldPassword": { "type": "string" },
                "newPassword": { "type": "string" }
              }
            },
            "example": {
              "oldPassword": "123456",
              "newPassword": "Abc@123456"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Thành công",
            "examples": {
              "application/json": {
                "message": "Password changed"
              }
            }
          }
        }
      }
    },

    "/user/me/addresses": {
      "post": {
        "tags": ["User"],
        "summary": "Thêm địa chỉ mới",
        "security": [{ "Bearer": [] }],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "schema": {
              "type": "object",
              "required": [
                "name",
                "phone",
                "province",
                "district",
                "ward",
                "detail"
              ],
              "properties": {
                "label": {
                  "type": "string",
                  "enum": ["home", "work", "school", "other"]
                },
                "name": { "type": "string" },
                "phone": { "type": "string" },
                "province": { "type": "string" },
                "district": { "type": "string" },
                "ward": { "type": "string" },
                "detail": { "type": "string" },
                "note": { "type": "string" },
                "isPrimary": { "type": "boolean" }
              }
            },
            "example": {
              "label": "home",
              "name": "Nguyễn Văn A",
              "phone": "0912345678",
              "province": "Hà Nội",
              "district": "Cầu Giấy",
              "ward": "Dịch Vọng",
              "detail": "Số 10, Ngõ 20",
              "isPrimary": true
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Tạo địa chỉ thành công",
            "examples": {
              "application/json": [
                {
                  "_id": "6754b8c12e9c2a4f77f1b5e2",
                  "label": "home",
                  "name": "Nguyễn Văn A",
                  "phone": "0912345678",
                  "isPrimary": true
                }
              ]
            }
          }
        }
      }
    },

    "/user/me/addresses/{idx}": {
      "put": {
        "tags": ["User"],
        "summary": "Cập nhật địa chỉ theo index",
        "security": [{ "Bearer": [] }],
        "parameters": [
          { "name": "idx", "in": "path", "required": true, "type": "integer" },
          {
            "in": "body",
            "name": "body",
            "schema": { "type": "object" },
            "example": {
              "note": "Giao buổi sáng",
              "isPrimary": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cập nhật thành công",
            "examples": {
              "application/json": [
                {
                  "label": "home",
                  "name": "Nguyễn Văn A",
                  "isPrimary": true
                }
              ]
            }
          }
        }
      },
      "delete": {
        "tags": ["User"],
        "summary": "Xóa địa chỉ theo index",
        "security": [{ "Bearer": [] }],
        "parameters": [
          { "name": "idx", "in": "path", "required": true, "type": "integer" }
        ],
        "responses": {
          "200": {
            "description": "Xóa thành công",
            "examples": {
              "application/json": []
            }
          }
        }
      }
    },

    "/user": {
      "get": {
        "tags": ["User"],
        "summary": "Lấy danh sách tất cả người dùng (admin)",
        "security": [{ "Bearer": [] }],
        "responses": {
          "200": {
            "description": "Danh sách user",
            "examples": {
              "application/json": [
                {
                  "id": "6754b6f82e9c2a4f77f1b5d1",
                  "name": "Nguyễn Văn A",
                  "email": "a@example.com",
                  "role": "user"
                }
              ]
            }
          }
        }
      }
    },

    "/user/{id}": {
      "get": {
        "tags": ["User"],
        "summary": "Xem chi tiết user theo ID (admin)",
        "security": [{ "Bearer": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "string" }
        ],
        "responses": {
          "200": {
            "description": "Chi tiết user",
            "examples": {
              "application/json": {
                "id": "6754b6f82e9c2a4f77f1b5d1",
                "name": "Nguyễn Văn A",
                "email": "a@example.com",
                "role": "user"
              }
            }
          }
        }
      },
      "put": {
        "tags": ["User"],
        "summary": "Cập nhật user theo ID (admin)",
        "security": [{ "Bearer": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "string" },
          {
            "in": "body",
            "name": "body",
            "schema": { "type": "object" },
            "example": {
              "role": "admin",
              "isSeller": true
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Cập nhật thành công",
            "examples": {
              "application/json": {
                "message": "User updated",
                "user": { "id": "6754b6f82e9c2a4f77f1b5d1", "role": "admin" }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["User"],
        "summary": "Xóa user theo ID (admin)",
        "security": [{ "Bearer": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "string" }
        ],
        "responses": {
          "200": {
            "description": "Xóa thành công",
            "examples": {
              "application/json": { "message": "User deleted" }
            }
          }
        }
      }
    },
    "/api/shops/register": {
      "post": {
        "tags": ["Shop"],
        "summary": "Register a new shop (User only)",
        "security": [{ "Bearer": [] }],
        "consumes": ["application/json"],
        "produces": ["application/json"],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "name": { "type": "string", "example": "Tiệm Trà Sữa Posu" },
                "phone": { "type": "string", "example": "0987654321" },
                "address": {
                  "type": "string",
                  "example": "123 Đường Hàn Thuyên"
                },
                "representative": {
                  "type": "object",
                  "example": {
                    "fullName": "Posu Do",
                    "email": "posu@example.com",
                    "phone": "0987654321",
                    "idNumber": "123456789",
                    "idIssuedDate": "2024-01-10",
                    "idIssuedPlace": "TPHCM",
                    "idCardFront": "https://cdn.com/idfront.jpg",
                    "idCardBack": "https://cdn.com/idback.jpg",
                    "businessLicenseFront": "https://cdn.com/blf.jpg",
                    "businessLicenseBack": "https://cdn.com/blb.jpg",
                    "taxCertificate": "https://cdn.com/tax.jpg"
                  }
                },
                "bank": {
                  "type": "object",
                  "example": {
                    "bankName": "Vietcombank",
                    "accountNumber": "1234567890",
                    "branch": "Chi nhánh Thủ Đức",
                    "accountHolder": "Posu Do"
                  }
                },
                "openHours": {
                  "type": "object",
                  "example": {
                    "sameAllWeek": true,
                    "monday": { "open": "08:00", "close": "22:00" }
                  }
                },
                "avatar": {
                  "type": "string",
                  "example": "https://cdn.com/avatar.jpg"
                },
                "cover": {
                  "type": "string",
                  "example": "https://cdn.com/cover.jpg"
                },
                "frontImage": {
                  "type": "string",
                  "example": "https://cdn.com/front.jpg"
                },
                "serviceCategory": {
                  "type": "string",
                  "example": "67335e524f02e1bd16f9a88c"
                },
                "cuisineCategory": {
                  "type": "string",
                  "example": "67335e524f02e1bd16f9a88d"
                },
                "productCategory": {
                  "type": "string",
                  "example": "67335e524f02e1bd16f9a88e"
                }
              },
              "required": ["name", "phone", "address"]
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Shop created successfully",
            "schema": {
              "type": "object",
              "example": {
                "message": "Shop registered and pending approval",
                "shop": {
                  "_id": "6733f0d024f23c6f9c28a77d",
                  "name": "Tiệm Trà Sữa Posu",
                  "status": "pending",
                  "createdAt": "2025-11-03T10:23:00Z"
                }
              }
            }
          },
          "400": {
            "description": "User can have only 1 shop or missing fields"
          },
          "500": { "description": "Server error" }
        }
      }
    },

    "/api/shops": {
      "get": {
        "tags": ["Shop"],
        "summary": "Get shops (admin gets all, user gets their own)",
        "security": [{ "Bearer": [] }],
        "responses": {
          "200": {
            "description": "List of shops",
            "schema": {
              "type": "array",
              "example": [
                {
                  "_id": "6733f0d024f23c6f9c28a77d",
                  "name": "Tiệm Trà Sữa Posu",
                  "status": "pending",
                  "owner": {
                    "_id": "672f8e1f88e4b00e2b07c211",
                    "name": "Do Posu",
                    "email": "posu@example.com"
                  },
                  "serviceCategory": {
                    "_id": "67335e524f02e1bd16f9a88c",
                    "name": "Ăn uống"
                  }
                }
              ]
            }
          }
        }
      }
    },

    "/api/shops/{id}": {
      "get": {
        "tags": ["Shop"],
        "summary": "Get shop details by ID",
        "security": [{ "Bearer": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "string" }
        ],
        "responses": {
          "200": {
            "description": "Shop details",
            "schema": {
              "type": "object",
              "example": {
                "_id": "6733f0d024f23c6f9c28a77d",
                "name": "Tiệm Trà Sữa Posu",
                "status": "pending",
                "address": "123 Đường Hàn Thuyên",
                "owner": {
                  "_id": "672f8e1f88e4b00e2b07c211",
                  "name": "Do Posu"
                }
              }
            }
          },
          "404": { "description": "Shop not found" }
        }
      },
      "put": {
        "tags": ["Shop"],
        "summary": "Update shop info (owner or admin)",
        "security": [{ "Bearer": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "string" },
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "type": "object",
              "example": {
                "name": "Tiệm Posu Tea - Cập nhật",
                "phone": "0912345678",
                "address": "456 Linh Trung, Thủ Đức"
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Shop updated",
            "schema": {
              "type": "object",
              "example": {
                "_id": "6733f0d024f23c6f9c28a77d",
                "name": "Tiệm Posu Tea - Cập nhật"
              }
            }
          },
          "400": { "description": "Approved shop can't be edited" },
          "403": { "description": "Forbidden" },
          "404": { "description": "Shop not found" }
        }
      },
      "delete": {
        "tags": ["Shop"],
        "summary": "Delete a shop (Admin only)",
        "security": [{ "Bearer": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "string" }
        ],
        "responses": {
          "200": {
            "description": "Shop deleted",
            "schema": {
              "type": "object",
              "example": { "message": "Shop deleted" }
            }
          },
          "404": { "description": "Shop not found" }
        }
      }
    },

    "/api/shops/{id}/approve": {
      "put": {
        "tags": ["Shop"],
        "summary": "Approve or reject shop (Admin only)",
        "security": [{ "Bearer": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "type": "string" },
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "status": {
                  "type": "string",
                  "enum": ["approved", "rejected", "pending"],
                  "example": "approved"
                },
                "reason": {
                  "type": "string",
                  "example": "Không đủ giấy tờ kinh doanh"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Shop approval updated",
            "schema": {
              "type": "object",
              "example": { "message": "Shop status updated to approved" }
            }
          },
          "400": { "description": "Invalid status" },
          "404": { "description": "Shop not found" }
        }
      }
    },
    "/api/categories": {
      "get": {
        "tags": ["Category"],
        "summary": "Get all categories",
        "description": "Retrieve all categories. You can filter by `type` and/or `parent` using query parameters.",
        "parameters": [
          {
            "name": "type",
            "in": "query",
            "description": "Filter categories by type (service, cuisine, or product)",
            "required": false,
            "type": "string",
            "enum": ["service", "cuisine", "product"]
          },
          {
            "name": "parent",
            "in": "query",
            "description": "Filter by parent category ID",
            "required": false,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "List of categories",
            "examples": {
              "application/json": [
                {
                  "_id": "671d9bfa9828f2b7a1c2ef5d",
                  "type": "product",
                  "name": "Trà sữa",
                  "parent": null,
                  "description": "Các loại trà sữa phổ biến",
                  "createdAt": "2025-11-03T10:00:00.000Z",
                  "updatedAt": "2025-11-03T10:00:00.000Z"
                }
              ]
            }
          }
        }
      },
      "post": {
        "tags": ["Category"],
        "summary": "Create a new category",
        "description": "Admin only. Creates a new category (service, cuisine, or product).",
        "security": [{ "Bearer": [] }],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": { "type": "object" },
            "example": {
              "type": "product",
              "name": "Trà sữa",
              "parent": null,
              "description": "Các loại trà sữa phổ biến"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Category created successfully",
            "examples": {
              "application/json": {
                "_id": "671d9bfa9828f2b7a1c2ef5d",
                "type": "product",
                "name": "Trà sữa",
                "parent": null,
                "description": "Các loại trà sữa phổ biến",
                "createdAt": "2025-11-03T10:00:00.000Z",
                "updatedAt": "2025-11-03T10:00:00.000Z"
              }
            }
          },
          "400": {
            "description": "Validation error",
            "examples": { "application/json": { "error": "Type is required" } }
          }
        }
      }
    },
    "/api/categories/{id}": {
      "get": {
        "tags": ["Category"],
        "summary": "Get category by ID",
        "description": "Retrieve a category by its ID.",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "Category ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Category details",
            "examples": {
              "application/json": {
                "_id": "671d9bfa9828f2b7a1c2ef5d",
                "type": "product",
                "name": "Trà sữa",
                "parent": null,
                "description": "Các loại trà sữa phổ biến",
                "createdAt": "2025-11-03T10:00:00.000Z",
                "updatedAt": "2025-11-03T10:00:00.000Z"
              }
            }
          },
          "404": {
            "description": "Category not found",
            "examples": {
              "application/json": { "error": "Category not found" }
            }
          }
        }
      },
      "put": {
        "tags": ["Category"],
        "summary": "Update category",
        "description": "Admin only. Update category fields by ID.",
        "security": [{ "Bearer": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "Category ID"
          },
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": { "type": "object" },
            "example": {
              "name": "Trà sữa đặc biệt",
              "description": "Trà sữa với topping đặc biệt"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Category updated successfully",
            "examples": {
              "application/json": {
                "_id": "671d9bfa9828f2b7a1c2ef5d",
                "type": "product",
                "name": "Trà sữa đặc biệt",
                "parent": null,
                "description": "Trà sữa với topping đặc biệt",
                "createdAt": "2025-11-03T10:00:00.000Z",
                "updatedAt": "2025-11-03T10:05:00.000Z"
              }
            }
          },
          "404": {
            "description": "Category not found",
            "examples": {
              "application/json": { "error": "Category not found" }
            }
          }
        }
      },
      "delete": {
        "tags": ["Category"],
        "summary": "Delete category",
        "description": "Admin only. Delete a category and its subcategories.",
        "security": [{ "Bearer": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "Category ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Category deleted successfully",
            "examples": { "application/json": { "message": "Deleted" } }
          },
          "404": {
            "description": "Category not found",
            "examples": {
              "application/json": { "error": "Category not found" }
            }
          }
        }
      }
    },
    "/notifications/me": {
      "get": {
        "tags": ["Notification"],
        "summary": "Get notifications of the current user",
        "description": "Returns a list of notifications belonging to the authenticated user. Can be filtered by targetType (user, seller, admin).",
        "security": [{ "Bearer": [] }],
        "parameters": [
          {
            "in": "query",
            "name": "type",
            "required": false,
            "description": "Target type of notifications (user, seller, admin).",
            "type": "string",
            "enum": ["user", "seller", "admin"]
          }
        ],
        "responses": {
          "200": {
            "description": "List of notifications for the current user",
            "examples": {
              "application/json": [
                {
                  "_id": "67275ad3b7f11a1234aef789",
                  "user": "67245abcde9b11a4d11f2345",
                  "sender": "671acdb4f123aa12000de789",
                  "message": "Your shop has been approved.",
                  "type": "system",
                  "targetType": "seller",
                  "metadata": {
                    "shopId": "671bcaa9f00a55222b44cc11",
                    "status": "approved"
                  },
                  "read": false,
                  "createdAt": "2025-11-03T09:35:00.123Z",
                  "updatedAt": "2025-11-03T09:35:00.123Z"
                }
              ]
            }
          },
          "401": { "description": "Unauthorized" }
        }
      }
    },
    "/notifications/{id}/read": {
      "put": {
        "tags": ["Notification"],
        "summary": "Mark a notification as read",
        "description": "Marks a specific notification belonging to the current user as read.",
        "security": [{ "Bearer": [] }],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "required": true,
            "type": "string",
            "description": "Notification ID to mark as read"
          }
        ],
        "responses": {
          "200": {
            "description": "Notification successfully marked as read",
            "examples": {
              "application/json": {
                "_id": "67275ad3b7f11a1234aef789",
                "user": "67245abcde9b11a4d11f2345",
                "sender": "671acdb4f123aa12000de789",
                "message": "Your shop has been approved.",
                "type": "system",
                "targetType": "seller",
                "metadata": {
                  "shopId": "671bcaa9f00a55222b44cc11",
                  "status": "approved"
                },
                "read": true,
                "createdAt": "2025-11-03T09:35:00.123Z",
                "updatedAt": "2025-11-03T09:37:10.000Z"
              }
            }
          },
          "404": { "description": "Notification not found" },
          "401": { "description": "Unauthorized" }
        }
      }
    },
    "/notifications": {
      "get": {
        "tags": ["Notification"],
        "summary": "Get all notifications (admin)",
        "description": "Admin can view all notifications in the system.",
        "security": [{ "Bearer": [] }],
        "responses": {
          "200": {
            "description": "List of all notifications in the system",
            "examples": {
              "application/json": [
                {
                  "_id": "67275ad3b7f11a1234aef789",
                  "user": {
                    "_id": "67245abcde9b11a4d11f2345",
                    "name": "Nguyen Van A",
                    "email": "a@example.com"
                  },
                  "sender": "671acdb4f123aa12000de789",
                  "message": "50% off on all menu items!",
                  "type": "promo",
                  "targetType": "user",
                  "metadata": {},
                  "read": false,
                  "createdAt": "2025-11-03T09:35:00.123Z",
                  "updatedAt": "2025-11-03T09:35:00.123Z"
                }
              ]
            }
          },
          "403": { "description": "Forbidden - admin access only" }
        }
      },
      "post": {
        "tags": ["Notification"],
        "summary": "Send notification (admin)",
        "description": "Admin can send a notification to a specific user or broadcast it to all users.",
        "security": [{ "Bearer": [] }],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "userId": {
                  "type": "string",
                  "description": "User ID to send notification to (leave empty to send to all users)"
                },
                "message": {
                  "type": "string",
                  "example": "The system will undergo maintenance at 10:00 PM."
                },
                "type": {
                  "type": "string",
                  "enum": ["order", "promo", "system"],
                  "example": "system"
                },
                "metadata": {
                  "type": "object",
                  "example": { "maintenanceTime": "22:00" }
                },
                "targetType": {
                  "type": "string",
                  "enum": ["user", "seller", "admin"],
                  "example": "user"
                }
              },
              "required": ["message"]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Notification successfully sent",
            "examples": {
              "application/json": {
                "_id": "67276111b7f11a1234aef789",
                "user": "67245abcde9b11a4d11f2345",
                "message": "The system will undergo maintenance at 10:00 PM.",
                "type": "system",
                "targetType": "user",
                "metadata": { "maintenanceTime": "22:00" },
                "read": false,
                "createdAt": "2025-11-03T09:45:00.000Z",
                "updatedAt": "2025-11-03T09:45:00.000Z"
              }
            }
          },
          "403": { "description": "Forbidden - admin access only" },
          "500": { "description": "Server error" }
        }
      }
    }
  }
}
